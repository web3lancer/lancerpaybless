(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[699],{3699:(e,t,a)=>{Promise.resolve().then(a.bind(a,69757))},53696:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var r=a(74219);class s{static async createUser(e){let t=new Date().toISOString();return await r.LL.createDocument(r.AH,r.WU.USERS,e.userId,{...e,createdAt:t,updatedAt:t})}static async getUser(e){return await r.LL.getDocument(r.AH,r.WU.USERS,e)}static async updateUser(e,t){return await r.LL.updateDocument(r.AH,r.WU.USERS,e,{...t,updatedAt:new Date().toISOString()})}static async getUserByEmail(e){try{return(await r.LL.listDocuments(r.AH,r.WU.USERS,[r.XK.equal("email",e)])).documents[0]||null}catch(e){return null}}static async getUserByUsername(e){try{return(await r.LL.listDocuments(r.AH,r.WU.USERS,[r.XK.equal("username",e)])).documents[0]||null}catch(e){return null}}static async createWallet(e){let t=r.ID.unique(),a=await r.LL.createDocument(r.AH,r.WU.WALLETS,t,{...e,walletName:e.name,walletAddress:e.address,walletId:t,createdAt:new Date().toISOString()});return a.name=a.walletName,a.address=a.walletAddress,a}static async getUserWallets(e){return(await r.LL.listDocuments(r.AH,r.WU.WALLETS,[r.XK.equal("userId",e),r.XK.equal("isActive",!0),r.XK.orderDesc("createdAt")])).documents.map(e=>({...e,name:e.walletName||e.name,address:e.walletAddress||e.address}))}static async getWallet(e){return await r.LL.getDocument(r.AH,r.WU.WALLETS,e)}static async updateWallet(e,t){return await r.LL.updateDocument(r.AH,r.WU.WALLETS,e,t)}static async setDefaultWallet(e,t){let a=await this.getUserWallets(e);return await Promise.all(a.map(e=>this.updateWallet(e.walletId,{isDefault:!1}))),await this.updateWallet(t,{isDefault:!0})}static async getTokens(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return(await r.LL.listDocuments(r.AH,r.WU.TOKENS,[r.XK.equal("isActive",!0),r.XK.orderAsc("name"),r.XK.limit(e)])).documents}static async getToken(e){return await r.LL.getDocument(r.AH,r.WU.TOKENS,e)}static async getTokenBySymbol(e){try{return(await r.LL.listDocuments(r.AH,r.WU.TOKENS,[r.XK.equal("symbol",e)])).documents[0]||null}catch(e){return null}}static async createTransaction(e){let t=r.ID.unique();return await r.LL.createDocument(r.AH,r.WU.TRANSACTIONS,t,{...e,transactionId:t,createdAt:new Date().toISOString()})}static async getUserTransactions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return(await r.LL.listDocuments(r.AH,r.WU.TRANSACTIONS,[r.XK.or([r.XK.equal("fromUserId",e),r.XK.equal("toUserId",e)]),r.XK.orderDesc("createdAt"),r.XK.limit(t)])).documents}static async getTransaction(e){return await r.LL.getDocument(r.AH,r.WU.TRANSACTIONS,e)}static async updateTransaction(e,t){return await r.LL.updateDocument(r.AH,r.WU.TRANSACTIONS,e,t)}static async createPaymentRequest(e){let t=r.ID.unique();return await r.LL.createDocument(r.AH,r.WU.PAYMENT_REQUESTS,t,{...e,requestId:t,createdAt:new Date().toISOString()})}static async getUserPaymentRequests(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sent";return(await r.LL.listDocuments(r.AH,r.WU.PAYMENT_REQUESTS,[r.XK.equal("sent"===t?"fromUserId":"toUserId",e),r.XK.orderDesc("createdAt")])).documents}static async getPaymentRequest(e){return await r.LL.getDocument(r.AH,r.WU.PAYMENT_REQUESTS,e)}static async updatePaymentRequest(e,t){await r.LL.updateDocument(r.AH,r.WU.PAYMENT_REQUESTS,e,t)}static async getPaymentRequestByInvoice(e){let t=await r.LL.listDocuments(r.AH,r.WU.PAYMENT_REQUESTS,[r.XK.equal("invoiceNumber",e)]);if(0===t.documents.length)throw Error("Payment request not found");return t.documents[0]}static async getExchangeRates(){return(await r.LL.listDocuments(r.AH,r.WU.EXCHANGE_RATES,[r.XK.equal("isActive",!0),r.XK.orderDesc("lastUpdated")])).documents}static async getExchangeRate(e,t){try{return(await r.LL.listDocuments(r.AH,r.WU.EXCHANGE_RATES,[r.XK.equal("fromCurrency",e),r.XK.equal("toCurrency",t),r.XK.equal("isActive",!0)])).documents[0]||null}catch(e){return null}}static async createSecurityLog(e){let t=r.ID.unique();return await r.LL.createDocument(r.AH,r.WU.SECURITY_LOGS,t,{...e,logId:t,createdAt:new Date().toISOString()})}static async getUserSecurityLogs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return(await r.LL.listDocuments(r.AH,r.WU.SECURITY_LOGS,[r.XK.equal("userId",e),r.XK.orderDesc("createdAt"),r.XK.limit(t)])).documents}static async createAPIKey(e){let t=r.ID.unique();return await r.LL.createDocument(r.AH,r.WU.API_KEYS,t,{...e,keyId:t,createdAt:new Date().toISOString()})}static async getUserAPIKeys(e){return(await r.LL.listDocuments(r.AH,r.WU.API_KEYS,[r.XK.equal("userId",e),r.XK.orderDesc("createdAt")])).documents}static async updateAPIKey(e,t){return await r.LL.updateDocument(r.AH,r.WU.API_KEYS,e,t)}static async deactivateAPIKey(e){return await this.updateAPIKey(e,{isActive:!1})}}},69757:(e,t,a)=>{"use strict";a.d(t,{AuthClient:()=>p});var r=a(74807),s=a(95423),n=a(63909),l=a(30760),i=a(96514),c=a(99847),o=a(93095),u=a(67138),d=a.n(u);function m(e){let{mode:t}=e;(0,o.useRouter)();let a=(0,o.useSearchParams)(),{signIn:u,signUp:m,sendMagicURL:p,sendEmailOTP:h,sendPhoneOTP:x,loginWithEmailOTP:y,loginWithMagicURL:w,loginWithPhoneOTP:g,signInWithGoogle:b,signInWithGithub:f,isLoading:S}=(0,c.A)(),[N,j]=(0,s.useState)("email_password"),[v,A]=(0,s.useState)({name:"",email:"",phone:"",password:"",confirmPassword:"",otp:""}),[L,E]=(0,s.useState)(!1),[U,P]=(0,s.useState)(!1),[_,D]=(0,s.useState)([]),[T,I]=(0,s.useState)(!1),[k,C]=(0,s.useState)(!1),[K,W]=(0,s.useState)(!1),[H,R]=(0,s.useState)("");(0,s.useEffect)(()=>{let e=null==a?void 0:a.get("userId"),t=null==a?void 0:a.get("secret");e&&t&&q(e,t)},[a]);let q=async(e,t)=>{try{I(!0),await w(e,t)}catch(e){D([e.message||"Failed to authenticate with magic link"])}finally{I(!1)}},O=(e,t)=>{A(a=>({...a,[e]:t})),D([])},X=()=>{let e=[];return("email_password"===N||"magic_url"===N||"email_otp"===N)&&(v.email?/\S+@\S+\.\S+/.test(v.email)||e.push("Please enter a valid email address"):e.push("Email is required")),"phone_otp"!==N||v.phone||e.push("Phone number is required"),"email_password"===N&&(v.password?v.password.length<8&&e.push("Password must be at least 8 characters long"):e.push("Password is required"),"signup"===t&&(v.name||e.push("Full name is required"),v.password!==v.confirmPassword&&e.push("Passwords do not match"))),D(e),0===e.length},F=async e=>{if(e.preventDefault(),X())try{if(I(!0),D([]),"email_password"===N)"signup"===t?await m(v.email,v.password,v.name):await u(v.email,v.password);else if("magic_url"===N)await p(v.email),W(!0);else if("email_otp"===N)if(k&&v.otp)await y(H,v.otp);else{let e=await h(v.email);R(e.userId),C(!0)}else if("phone_otp"===N)if(k&&v.otp)await g(H,v.otp);else{let e=await x(v.phone);R(e.userId),C(!0)}}catch(e){D([e.message||"An error occurred during authentication"])}finally{I(!1)}},B=async e=>{try{"google"===e?await b():await f()}catch(t){D([t.message||"Failed to sign in with ".concat(e)])}},Y=()=>{C(!1),W(!1),R(""),A({name:"",email:"",phone:"",password:"",confirmPassword:"",otp:""})},M=e=>{j(e),Y(),D([])};return(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"max-w-md w-full space-y-8",children:(0,r.jsxs)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"mt-6 text-3xl font-bold text-neutral-900",children:"login"===t?"Sign in to your account":"Create your account"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-neutral-600",children:"login"===t?(0,r.jsxs)(r.Fragment,{children:["Or"," ",(0,r.jsx)(d(),{href:"/auth/signup",className:"font-medium text-primary-600 hover:text-primary-500",children:"create a new account"})]}):(0,r.jsxs)(r.Fragment,{children:["Or"," ",(0,r.jsx)(d(),{href:"/auth/login",className:"font-medium text-primary-600 hover:text-primary-500",children:"sign in to your existing account"})]})})]}),(0,r.jsxs)("div",{className:"mt-8 bg-white py-8 px-6 shadow-sm rounded-lg border border-neutral-200",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>M("email_password"),className:"flex items-center justify-center px-3 py-2 text-sm border rounded-md transition-colors ".concat("email_password"===N?"border-primary-500 bg-primary-50 text-primary-700":"border-neutral-300 text-neutral-700 hover:bg-neutral-50"),children:[(0,r.jsx)(l.F5$,{className:"mr-2 h-4 w-4"}),"Password"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>M("magic_url"),className:"flex items-center justify-center px-3 py-2 text-sm border rounded-md transition-colors ".concat("magic_url"===N?"border-primary-500 bg-primary-50 text-primary-700":"border-neutral-300 text-neutral-700 hover:bg-neutral-50"),children:[(0,r.jsx)(l.pHD,{className:"mr-2 h-4 w-4"}),"Magic Link"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>M("email_otp"),className:"flex items-center justify-center px-3 py-2 text-sm border rounded-md transition-colors ".concat("email_otp"===N?"border-primary-500 bg-primary-50 text-primary-700":"border-neutral-300 text-neutral-700 hover:bg-neutral-50"),children:[(0,r.jsx)(l.pcC,{className:"mr-2 h-4 w-4"}),"Email OTP"]}),(0,r.jsxs)("button",{type:"button",onClick:()=>M("phone_otp"),className:"flex items-center justify-center px-3 py-2 text-sm border rounded-md transition-colors ".concat("phone_otp"===N?"border-primary-500 bg-primary-50 text-primary-700":"border-neutral-300 text-neutral-700 hover:bg-neutral-50"),children:[(0,r.jsx)(l.PCV,{className:"mr-2 h-4 w-4"}),"SMS OTP"]})]})]}),_.length>0&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,r.jsx)("ul",{className:"text-sm text-red-600 space-y-1",children:_.map((e,t)=>(0,r.jsx)("li",{children:e},t))})}),K&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-green-600",children:"Magic link sent! Check your email and click the link to sign in."})}),k&&"email_otp"===N&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-blue-600",children:"OTP sent to your email! Enter the 6-digit code below."})}),k&&"phone_otp"===N&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-blue-600",children:"OTP sent to your phone! Enter the 6-digit code below."})}),(0,r.jsxs)("form",{onSubmit:F,className:"space-y-4",children:["signup"===t&&"email_password"===N&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Full Name"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(l.JXP,{className:"h-5 w-5 text-neutral-400"})}),(0,r.jsx)("input",{id:"name",type:"text",value:v.name,onChange:e=>O("name",e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your full name"})]})]}),("email_password"===N||"magic_url"===N||"email_otp"===N)&&!k&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Email Address"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(l.pHD,{className:"h-5 w-5 text-neutral-400"})}),(0,r.jsx)("input",{id:"email",type:"email",value:v.email,onChange:e=>O("email",e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your email"})]})]}),"phone_otp"===N&&!k&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Phone Number"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(l.PCV,{className:"h-5 w-5 text-neutral-400"})}),(0,r.jsx)("input",{id:"phone",type:"tel",value:v.phone,onChange:e=>O("phone",e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"+1 (555) 123-4567"})]})]}),"email_password"===N&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(l.F5$,{className:"h-5 w-5 text-neutral-400"})}),(0,r.jsx)("input",{id:"password",type:L?"text":"password",value:v.password,onChange:e=>O("password",e.target.value),className:"block w-full pl-10 pr-10 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter your password"}),(0,r.jsx)("button",{type:"button",onClick:()=>E(!L),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:L?(0,r.jsx)(l._NO,{className:"h-5 w-5 text-neutral-400"}):(0,r.jsx)(l.Vap,{className:"h-5 w-5 text-neutral-400"})})]})]}),"signup"===t&&"email_password"===N&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Confirm Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(l.F5$,{className:"h-5 w-5 text-neutral-400"})}),(0,r.jsx)("input",{id:"confirmPassword",type:U?"text":"password",value:v.confirmPassword,onChange:e=>O("confirmPassword",e.target.value),className:"block w-full pl-10 pr-10 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Confirm your password"}),(0,r.jsx)("button",{type:"button",onClick:()=>P(!U),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:U?(0,r.jsx)(l._NO,{className:"h-5 w-5 text-neutral-400"}):(0,r.jsx)(l.Vap,{className:"h-5 w-5 text-neutral-400"})})]})]}),k&&("email_otp"===N||"phone_otp"===N)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"otp",className:"block text-sm font-medium text-neutral-700 mb-1",children:"Enter OTP Code"}),(0,r.jsx)("input",{id:"otp",type:"text",value:v.otp,onChange:e=>O("otp",e.target.value),className:"block w-full px-3 py-2 border border-neutral-300 rounded-md placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-center text-lg tracking-widest",placeholder:"123456",maxLength:6})]}),!K&&(0,r.jsx)("button",{type:"submit",disabled:T||S,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:T||S?(0,r.jsx)(l.TwU,{className:"animate-spin h-5 w-5"}):(0,r.jsxs)(r.Fragment,{children:["email_password"===N&&("login"===t?"Sign In":"Sign Up"),"magic_url"===N&&"Send Magic Link","email_otp"===N&&(k?"Verify OTP":"Send OTP"),"phone_otp"===N&&(k?"Verify OTP":"Send SMS")]})})]}),!k&&!K&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-neutral-300"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,r.jsx)("span",{className:"px-2 bg-white text-neutral-500",children:"Or continue with"})})]})}),(0,r.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>B("google"),className:"w-full inline-flex justify-center py-2 px-4 border border-neutral-300 rounded-md shadow-sm bg-white text-sm font-medium text-neutral-500 hover:bg-neutral-50 transition-colors",children:[(0,r.jsx)(i.F4b,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"ml-2",children:"Google"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>B("github"),className:"w-full inline-flex justify-center py-2 px-4 border border-neutral-300 rounded-md shadow-sm bg-white text-sm font-medium text-neutral-500 hover:bg-neutral-50 transition-colors",children:[(0,r.jsx)(l.BR8,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"ml-2",children:"GitHub"})]})]})]}),"login"===t&&"email_password"===N&&!k&&(0,r.jsx)("div",{className:"mt-6 text-center",children:(0,r.jsx)(d(),{href:"/auth/forgot-password",className:"text-sm text-primary-600 hover:text-primary-500",children:"Forgot your password?"})})]})]})})})}function p(e){let{mode:t}=e;return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600"})}),children:(0,r.jsx)(m,{mode:t})})}},74219:(e,t,a)=>{"use strict";a.d(t,{AH:()=>i,ID:()=>r.ID,LL:()=>l,WU:()=>c,XK:()=>r.XK,ct:()=>n});var r=a(69960);let s=new r.Kj;s.setEndpoint("https://fra.cloud.appwrite.io/v1").setProject("68399b0c0018d6ce71bc");let n=new r.gD(s),l=new r.Lv(s);new r.wc(s);let i="683a31960011608eaee5",c={USERS:"users",WALLETS:"wallets",TOKENS:"tokens",TRANSACTIONS:"transactions",PAYMENT_REQUESTS:"payment_requests",EXCHANGE_RATES:"exchange_rates",SECURITY_LOGS:"security_logs",API_KEYS:"api_keys"}},85430:(e,t,a)=>{"use strict";a.r(t),a.d(t,{AuthProvider:()=>c,useAuth:()=>o});var r=a(74807),s=a(95423),n=a(53696),l=a(74219);let i=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,s.useState)(null),[o,u]=(0,s.useState)(null),[d,m]=(0,s.useState)(!0),p=e=>e.split("@")[0].toLowerCase().replace(/[^a-z0-9]/g,""),h=async e=>{try{let t=await n.B.getUser(e.$id);if(t)return u(t),t}catch(e){console.log("Creating new user profile...")}try{let t=p(e.email),a={userId:e.$id,email:e.email,username:t,displayName:e.name||t,kycStatus:"pending",kycLevel:0,twoFactorEnabled:!1,isActive:!0,preferredCurrency:"USD"},r=await n.B.createUser(a);return u(r),await n.B.createSecurityLog({userId:e.$id,action:"profile_created",ipAddress:"unknown",success:!0,riskScore:0}),r}catch(e){throw console.error("Failed to create user profile:",e),e}},x=async()=>{if(a)try{let e=await n.B.getUser(a.$id);u(e)}catch(e){console.error("Failed to refresh profile:",e)}},y=async(e,t)=>{m(!0);try{await l.ct.createEmailPasswordSession(e,t);let a=await l.ct.get();c(a),await h(a),await n.B.createSecurityLog({userId:a.$id,action:"login_success",ipAddress:"unknown",success:!0,riskScore:0})}catch(t){if(e)try{let t=await n.B.getUserByEmail(e);t&&await n.B.createSecurityLog({userId:t.userId,action:"login_failed",ipAddress:"unknown",success:!1,riskScore:3})}catch(e){console.error("Failed to log security event:",e)}throw t}finally{m(!1)}},w=async(e,t,a)=>{m(!0);try{await l.ct.create("unique()",e,t,a),await l.ct.createEmailPasswordSession(e,t);let r=await l.ct.get();c(r),await h(r)}catch(e){throw e}finally{m(!1)}},g=async()=>{try{a&&await n.B.createSecurityLog({userId:a.$id,action:"logout",ipAddress:"unknown",success:!0,riskScore:0}),await l.ct.deleteSession("current"),c(null),u(null)}catch(e){console.error("Logout failed:",e)}};return(0,s.useEffect)(()=>{(async()=>{m(!0);try{let e=await l.ct.get();c(e),await h(e)}catch(e){c(null),u(null)}finally{m(!1)}})()},[]),(0,r.jsx)(i.Provider,{value:{user:a,userProfile:o,isLoading:d,login:y,register:w,logout:g,refreshProfile:x},children:t})}function o(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},93095:(e,t,a)=>{"use strict";var r=a(9103);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},99847:(e,t,a)=>{"use strict";a.d(t,{A:()=>r.useAuth,O:()=>r.AuthProvider});var r=a(85430)}}]);