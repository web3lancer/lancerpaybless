(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[165],{14353:(e,t,a)=>{"use strict";a.d(t,{O:()=>r.useTransaction});var r=a(68080)},25438:(e,t,a)=>{Promise.resolve().then(a.bind(a,62607))},34712:(e,t,a)=>{"use strict";a.d(t,{v:()=>r.useWallet});var r=a(86033)},35714:(e,t,a)=>{"use strict";a.d(t,{i:()=>r.useExchangeRate});var r=a(62189)},49969:(e,t,a)=>{"use strict";a.d(t,{G:()=>s});var r=a(74807);function s(e){let{children:t}=e;return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsx)("main",{children:t})})}a(95423)},62189:(e,t,a)=>{"use strict";a.r(t),a.d(t,{ExchangeRateProvider:()=>c,useExchangeRate:()=>l});var r=a(74807),s=a(95423);class n{static async getExchangeRate(e){let t=this.cache.get(e);if(t&&Date.now()-t.timestamp<this.CACHE_DURATION)return t.rate;try{let t=this.TOKEN_MAPPING[e.toLowerCase()];if(!t)return console.warn("No CoinGecko mapping for token: ".concat(e)),this.getMockRate(e);let a=await fetch("".concat(this.COINGECKO_API,"/simple/price?ids=").concat(t,"&vs_currencies=usd&include_24hr_change=true"),{headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status));let r=(await a.json())[t];if(!r)throw Error("No price data for ".concat(t));let s={tokenId:e.toLowerCase(),symbol:e.toUpperCase(),name:this.getTokenName(e),price_usd:r.usd,price_change_24h:r.usd_24h_change||0,last_updated:new Date().toISOString()};return this.cache.set(e,{rate:s,timestamp:Date.now()}),s}catch(t){return console.error("Failed to fetch exchange rate for ".concat(e,":"),t),this.getMockRate(e)}}static async getMultipleExchangeRates(e){let t=[...new Set(e.map(e=>e.toLowerCase()))],a=t.map(e=>this.TOKEN_MAPPING[e]).filter(Boolean);if(0===a.length)return t.map(e=>this.getMockRate(e)).filter(Boolean);try{let e=await fetch("".concat(this.COINGECKO_API,"/simple/price?ids=").concat(a.join(","),"&vs_currencies=usd&include_24hr_change=true"),{headers:{Accept:"application/json"},signal:AbortSignal.timeout(15e3)});if(!e.ok)throw Error("HTTP ".concat(e.status));let r=await e.json(),s=[];for(let e of t){let t=r[this.TOKEN_MAPPING[e]];if(t){let a={tokenId:e,symbol:e.toUpperCase(),name:this.getTokenName(e),price_usd:t.usd,price_change_24h:t.usd_24h_change||0,last_updated:new Date().toISOString()};this.cache.set(e,{rate:a,timestamp:Date.now()}),s.push(a)}else{let t=this.getMockRate(e);t&&s.push(t)}}return s}catch(e){return console.error("Failed to fetch multiple exchange rates:",e),t.map(e=>this.getMockRate(e)).filter(Boolean)}}static calculateUsdValue(e,t,a){let r="string"==typeof e?parseFloat(e):e;if(isNaN(r))return 0;if(a)return r*a.price_usd;let s=this.getMockRate(t);return s?r*s.price_usd:0}static formatUsdValue(e){return e>=1e6?"$".concat((e/1e6).toFixed(2),"M"):e>=1e3?"$".concat((e/1e3).toFixed(2),"K"):"$".concat(e.toFixed(2))}static formatPriceChange(e){let t=e>=0;return{text:"".concat(t?"+":"").concat(e.toFixed(2),"%"),color:t?"text-green-600":"text-red-600"}}static getMockRate(e){let t={btc:{price:43e3,name:"Bitcoin"},eth:{price:2400,name:"Ethereum"},matic:{price:.85,name:"Polygon"},bnb:{price:310,name:"BNB"},usdt:{price:1,name:"Tether"},usdc:{price:1,name:"USD Coin"},ada:{price:.45,name:"Cardano"},sol:{price:95,name:"Solana"},dot:{price:7.2,name:"Polkadot"},avax:{price:35,name:"Avalanche"}}[e.toLowerCase()];return t?{tokenId:e.toLowerCase(),symbol:e.toUpperCase(),name:t.name,price_usd:t.price,price_change_24h:(Math.random()-.5)*10,last_updated:new Date().toISOString()}:null}static getTokenName(e){return({btc:"Bitcoin",eth:"Ethereum",matic:"Polygon",bnb:"BNB",usdt:"Tether",usdc:"USD Coin",ada:"Cardano",sol:"Solana",dot:"Polkadot",avax:"Avalanche"})[e.toLowerCase()]||e.toUpperCase()}static clearCache(){this.cache.clear()}static getCacheSize(){return this.cache.size}}n.COINGECKO_API="https://api.coingecko.com/api/v3",n.CACHE_DURATION=3e5,n.cache=new Map,n.TOKEN_MAPPING={btc:"bitcoin",eth:"ethereum",matic:"matic-network",bnb:"binancecoin",usdt:"tether",usdc:"usd-coin",ada:"cardano",sol:"solana",dot:"polkadot",avax:"avalanche-2"};let o=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,s.useState)({}),[l,i]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),m=["btc","eth","matic","bnb","usdt","usdc"],h=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m;i(!0);try{let t=await n.getMultipleExchangeRates(e),a={};t.forEach(e=>{a[e.tokenId]=e}),c(e=>({...e,...a})),u(new Date)}catch(e){console.error("Failed to refresh exchange rates:",e)}finally{i(!1)}},p=e=>a[e.toLowerCase()]||null;return(0,s.useEffect)(()=>{h();let e=setInterval(()=>{h()},3e5);return()=>clearInterval(e)},[]),(0,s.useEffect)(()=>{let e=()=>{!document.hidden&&d&&Date.now()-d.getTime()>12e4&&h()};return document.addEventListener("visibilitychange",e),()=>document.removeEventListener("visibilitychange",e)},[d]),(0,r.jsx)(o.Provider,{value:{rates:a,isLoading:l,lastUpdated:d,refreshRates:h,getRate:p,calculateUsdValue:(e,t)=>{let a=p(t);return n.calculateUsdValue(e,t,a||void 0)},formatUsdValue:e=>n.formatUsdValue(e),formatPriceChange:e=>n.formatPriceChange(e)},children:t})}function l(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useExchangeRate must be used within an ExchangeRateProvider");return e}},62607:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var r=a(74807),s=a(95423),n=a(93095),o=a(99847),c=a(34712),l=a(14353),i=a(35714),d=a(49969),u=a(30760),m=a(67138),h=a.n(m);function p(){let e=(0,n.useRouter)(),{user:t}=(0,o.A)(),{wallets:a,defaultWallet:m}=(0,c.v)(),{sendTransaction:p}=(0,l.O)(),{calculateUsdValue:x,formatUsdValue:b}=(0,i.i)(),[f,g]=(0,s.useState)(!1),[v,w]=(0,s.useState)(""),[N,y]=(0,s.useState)(""),[j,C]=(0,s.useState)({fromWalletId:(null==m?void 0:m.walletId)||"",toAddress:"",amount:"",tokenId:"btc",description:""}),k=a.find(e=>e.walletId===j.fromWalletId),I=k&&j.amount?x(j.amount,k.blockchain):0,S=async a=>{if(a.preventDefault(),t&&k){g(!0),y(""),w("");try{let t=await p({toAddress:j.toAddress,tokenId:j.tokenId,amount:j.amount,description:j.description,fromWalletId:j.fromWalletId});w("Transaction created! ID: ".concat(t.transactionId)),C({fromWalletId:(null==m?void 0:m.walletId)||"",toAddress:"",amount:"",tokenId:"btc",description:""}),setTimeout(()=>{e.push("/")},3e3)}catch(e){y(e.message||"Failed to send transaction")}finally{g(!1)}}},_=(e,t)=>{if(!e)return!1;switch(t){case"bitcoin":return e.startsWith("bc1")||e.startsWith("1")||e.startsWith("3");case"ethereum":case"polygon":case"bsc":return e.startsWith("0x")&&42===e.length;default:return!1}};return(0,r.jsx)(d.G,{children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-2xl",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)(h(),{href:"/",className:"inline-flex items-center text-neutral-600 hover:text-neutral-900 mb-4",children:[(0,r.jsx)(u.kRp,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Send Crypto"}),(0,r.jsx)("p",{className:"text-neutral-600 mt-2",children:"Send cryptocurrency to any wallet address"})]}),N&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.y3G,{className:"w-5 h-5 text-red-500 mr-2"}),(0,r.jsx)("span",{className:"text-red-700",children:N})]})}),v&&(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(u.YrT,{className:"w-5 h-5 text-green-500 mr-2"}),(0,r.jsx)("span",{className:"text-green-700",children:v})]})}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"From Wallet"}),(0,r.jsxs)("select",{value:j.fromWalletId,onChange:e=>C({...j,fromWalletId:e.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select wallet"}),a.map(e=>(0,r.jsxs)("option",{value:e.walletId,children:[e.walletName," (",e.blockchain,") - Balance: ",e.balance]},e.walletId))]}),k&&(0,r.jsxs)("p",{className:"text-sm text-neutral-500 mt-2",children:["Address: ",k.walletAddress]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"To Address"}),(0,r.jsx)("input",{type:"text",required:!0,value:j.toAddress,onChange:e=>C({...j,toAddress:e.target.value}),placeholder:k?"Enter ".concat(k.blockchain," address"):"Enter wallet address",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),j.toAddress&&k&&!_(j.toAddress,k.blockchain)&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1",children:["Invalid ",k.blockchain," address format"]})]}),k&&(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Token"}),(0,r.jsx)("select",{value:j.tokenId,onChange:e=>C({...j,tokenId:e.target.value}),className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0,children:(({bitcoin:[{id:"btc",name:"Bitcoin",symbol:"BTC"}],ethereum:[{id:"eth",name:"Ethereum",symbol:"ETH"},{id:"usdt",name:"Tether USD",symbol:"USDT"},{id:"usdc",name:"USD Coin",symbol:"USDC"}],polygon:[{id:"matic",name:"Polygon",symbol:"MATIC"},{id:"usdc",name:"USD Coin",symbol:"USDC"}],bsc:[{id:"bnb",name:"BNB",symbol:"BNB"},{id:"usdt",name:"Tether USD",symbol:"USDT"}]})[k.blockchain]||[]).map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.symbol,")"]},e.id))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Amount"}),(0,r.jsx)("input",{type:"number",step:"0.000001",min:"0",required:!0,value:j.amount,onChange:e=>C({...j,amount:e.target.value}),placeholder:"0.00",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"}),k&&parseFloat(j.amount)>k.balance&&(0,r.jsxs)("p",{className:"text-sm text-red-500 mt-1",children:["Insufficient balance. Available: ",k.balance]}),I>0&&(0,r.jsxs)("p",{className:"text-sm text-neutral-500 mt-1",children:["Approx. USD Value: ",b(I)]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-neutral-200 p-6",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:"Description (Optional)"}),(0,r.jsx)("input",{type:"text",value:j.description,onChange:e=>C({...j,description:e.target.value}),placeholder:"Payment description",className:"w-full px-3 py-2 border border-neutral-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent"})]}),(0,r.jsxs)("div",{className:"flex space-x-4",children:[(0,r.jsx)(h(),{href:"/",className:"flex-1 px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors text-center",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:f||!(j.fromWalletId&&j.toAddress&&j.amount&&parseFloat(j.amount)>0&&k&&_(j.toAddress,k.blockchain)),className:"flex-1 px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:f?"Sending...":(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.kGk,{className:"w-4 h-4 mr-2"}),"Send Transaction"]})})]})]})]})})}},68080:(e,t,a)=>{"use strict";a.r(t),a.d(t,{TransactionProvider:()=>c,useTransaction:()=>l});var r=a(74807),s=a(95423),n=a(53696);let o=(0,s.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,s.useState)([]),[l,i]=(0,s.useState)(!1),d=async()=>{i(!0);try{let e=await n.B.getUserTransactions("current-user-id");c(e)}catch(e){console.error("Failed to load transactions:",e)}finally{i(!1)}},u=async e=>{try{let t=await n.B.createTransaction(e);return await d(),t.transactionId}catch(e){throw console.error("Failed to send transaction:",e),e}},m=async()=>{await d()};return(0,s.useEffect)(()=>{d()},[]),(0,r.jsx)(o.Provider,{value:{transactions:a,isLoading:l,sendTransaction:u,getTransactionsByWallet:e=>a.filter(t=>t.fromWalletId===e||t.toAddress===e),refreshTransactions:m},children:t})}function l(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useTransaction must be used within a TransactionProvider");return e}},93095:(e,t,a)=>{"use strict";var r=a(9103);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[215,960,898,33,412,640,358],()=>t(25438)),_N_E=e.O()}]);