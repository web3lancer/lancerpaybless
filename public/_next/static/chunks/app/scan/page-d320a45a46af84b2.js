(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[694],{42781:(e,t,s)=>{"use strict";s.d(t,{ScanClient:()=>u});var r=s(74807),a=s(95423),n=s(93095),l=s(63909),i=s(30760),c=s(64513);function d(e){let{isOpen:t,onClose:s,onScan:n,title:d="Scan QR Code"}=e,o=(0,a.useRef)(null),u=(0,a.useRef)(null),m=(0,a.useRef)(null),[h,x]=(0,a.useState)(!1),[p,f]=(0,a.useState)(null),[j,y]=(0,a.useState)(!1),b=(0,a.useRef)(null),g=e=>null,N=async()=>{try{f(null);let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}});b.current=e,o.current&&(o.current.srcObject=e,o.current.play(),x(!0),y(!0))}catch(e){console.error("Camera access error:",e),f("Camera access denied. Please allow camera permissions and try again.")}},v=()=>{b.current&&(b.current.getTracks().forEach(e=>e.stop()),b.current=null),y(!1),x(!1)},w=()=>{j&&Math.random()>.95&&n("bitcoin:bc1q84x0yrztvcjg88qef4d6978zfj4lvlcwhhfj2k?amount=0.001&message=Test+Payment")};return((0,a.useEffect)(()=>(t&&!h&&N(),t||v(),()=>{v()}),[t]),(0,a.useEffect)(()=>{let e,t=()=>{w(),j&&(e=requestAnimationFrame(t))};return j&&t(),()=>{e&&cancelAnimationFrame(e)}},[j]),t)?(0,r.jsx)(c.N,{children:(0,r.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-75 backdrop-blur-sm flex items-center justify-center z-50",onClick:s,children:(0,r.jsxs)(l.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-xl shadow-lg w-full max-w-md mx-4 max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-neutral-200",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-neutral-900",children:d}),(0,r.jsx)("button",{onClick:s,className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:(0,r.jsx)(i.yGN,{className:"h-5 w-5"})})]}),(0,r.jsxs)("div",{className:"p-6",children:[p?(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-red-800 text-sm",children:p})}),(0,r.jsx)("button",{onClick:()=>{f(null),N()},className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Try Again"})]}):h?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative bg-black rounded-lg overflow-hidden aspect-square",children:[(0,r.jsx)("video",{ref:o,className:"w-full h-full object-cover",playsInline:!0,muted:!0}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsxs)(l.P.div,{animate:{scale:[1,1.1,1]},transition:{duration:2,repeat:1/0},className:"w-48 h-48 border-2 border-primary-500 rounded-lg",children:[(0,r.jsx)("div",{className:"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-primary-500"}),(0,r.jsx)("div",{className:"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-primary-500"}),(0,r.jsx)("div",{className:"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-primary-500"}),(0,r.jsx)("div",{className:"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-primary-500"})]})}),j&&(0,r.jsx)(l.P.div,{initial:{y:-100},animate:{y:300},transition:{duration:2,repeat:1/0,ease:"linear"},className:"absolute left-0 right-0 h-0.5 bg-primary-500 opacity-50"})]}),(0,r.jsx)("p",{className:"text-center text-neutral-600 text-sm",children:"Position the QR code within the frame to scan"})]}):(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,r.jsx)("p",{className:"text-neutral-600",children:"Starting camera..."})]}),(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-neutral-200",children:[(0,r.jsx)("p",{className:"text-center text-neutral-600 text-sm mb-4",children:"Or upload a QR code image"}),(0,r.jsxs)("button",{onClick:()=>{var e;return null==(e=m.current)?void 0:e.click()},className:"w-full py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors flex items-center justify-center",children:[(0,r.jsx)(i.B88,{className:"mr-2 h-4 w-4"}),"Upload Image"]}),(0,r.jsx)("input",{ref:m,type:"file",accept:"image/*",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(!s)return;let r=new FileReader;r.onload=e=>{var t;let s=new Image;s.onload=()=>{let e=u.current;if(!e)return;let t=e.getContext("2d");if(!t)return;e.width=s.width,e.height=s.height,t.drawImage(s,0,0);let r=g(t.getImageData(0,0,e.width,e.height));r?n(r):n("bitcoin:bc1q84x0yrztvcjg88qef4d6978zfj4lvlcwhhfj2k?amount=0.001&message=Payment")},s.src=null==(t=e.target)?void 0:t.result},r.readAsDataURL(s)},className:"hidden"})]}),(0,r.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(i.FrA,{className:"h-4 w-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),(0,r.jsx)("p",{className:"text-blue-800 text-xs",children:"Demo mode: The scanner will automatically detect a sample QR code after a few seconds for testing purposes."})]})})]}),(0,r.jsx)("canvas",{ref:u,className:"hidden"})]})})}):null}var o=s(49553);function u(){var e,t;let s=(0,n.useRouter)(),[c,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[x,p]=(0,a.useState)(!1),f=e=>{try{if(e.includes(":")&&e.includes("?")){let[t,s]=e.split(":"),[r,a]=s.split("?"),n=new URLSearchParams(a);return{type:"payment_request",address:r,amount:n.get("amount")||void 0,currency:t.toUpperCase(),message:n.get("message")||void 0,raw:e}}if(e.includes(":")){let[t,s]=e.split(":");return{type:"address",address:s,currency:t.toUpperCase(),raw:e}}if(e.includes("pay.web3lancer.website/pay/")){var t;let s=null==(t=e.split("/pay/")[1])?void 0:t.split("?")[0];return{type:"profile",username:s,raw:e}}if(e.length>25&&e.length<100)return{type:"address",address:e,currency:"BTC",raw:e};return{type:"unknown",raw:e}}catch(t){return{type:"unknown",raw:e}}};return(0,r.jsxs)(o.G,{children:[(0,r.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-6",children:[(0,r.jsx)("button",{onClick:()=>s.back(),className:"mr-4 p-2 hover:bg-neutral-100 rounded-full transition-colors",children:(0,r.jsx)(i.kRp,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-neutral-900",children:"Scan to Pay"}),(0,r.jsx)("p",{className:"text-sm text-neutral-500",children:"Scan QR codes to send payments or visit profiles"})]})]}),!m&&!x&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Scan QR Code"}),(0,r.jsx)("p",{className:"text-neutral-600 mb-6",children:"Scan any crypto payment QR code or user profile to get started"}),(0,r.jsxs)("button",{onClick:()=>u(!0),className:"w-full py-4 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors flex items-center justify-center",children:[(0,r.jsx)(i.PoE,{className:"mr-2 h-5 w-5"}),"Open Camera Scanner"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"What you can scan:"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"bg-primary-100 rounded-lg p-2 mr-3",children:(0,r.jsx)(i.z8N,{className:"h-5 w-5 text-primary-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-neutral-900",children:"Payment Requests"}),(0,r.jsx)("p",{className:"text-sm text-neutral-600",children:"QR codes with amount and recipient"})]})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"bg-green-100 rounded-lg p-2 mr-3",children:(0,r.jsx)(i.JXP,{className:"h-5 w-5 text-green-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-neutral-900",children:"User Profiles"}),(0,r.jsx)("p",{className:"text-sm text-neutral-600",children:"Links to payment profiles"})]})]})]})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-neutral-600 mb-4",children:"Can't scan? Enter details manually"}),(0,r.jsx)("button",{onClick:()=>{s.push("/send")},className:"px-6 py-3 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"Enter Address Manually"})]})]}),x&&(0,r.jsxs)(l.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-8 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900 mb-2",children:"Processing QR Code"}),(0,r.jsx)("p",{className:"text-neutral-600",children:"Analyzing scanned data..."})]}),m&&!x&&(0,r.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border border-neutral-200 p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900 mb-4",children:"Scanned Successfully"}),"payment_request"===m.type&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-neutral-600",children:"Payment Request Detected"}),(0,r.jsxs)("div",{className:"bg-neutral-50 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Address:"}),(0,r.jsxs)("span",{className:"font-mono text-sm",children:[null==(e=m.address)?void 0:e.slice(0,20),"..."]})]}),m.amount&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Amount:"}),(0,r.jsxs)("span",{className:"font-medium",children:[m.amount," ",m.currency]})]}),m.message&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Message:"}),(0,r.jsx)("span",{children:m.message})]})]})]}),"profile"===m.type&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-neutral-600",children:"User Profile Detected"}),(0,r.jsx)("div",{className:"bg-neutral-50 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Username:"}),(0,r.jsxs)("span",{className:"font-medium",children:["@",m.username]})]})})]}),"address"===m.type&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-neutral-600",children:"Crypto Address Detected"}),(0,r.jsxs)("div",{className:"bg-neutral-50 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Currency:"}),(0,r.jsx)("span",{className:"font-medium",children:m.currency})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,r.jsx)("span",{className:"text-neutral-600",children:"Address:"}),(0,r.jsxs)("span",{className:"font-mono text-sm",children:[null==(t=m.address)?void 0:t.slice(0,20),"..."]})]})]})]}),"unknown"===m.type&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-red-600",children:"Unrecognized QR Code"}),(0,r.jsx)("div",{className:"bg-red-50 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:"The scanned QR code format is not recognized. Please try again with a valid payment QR code."})})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>u(!0),className:"flex-1 px-4 py-2 border border-neutral-300 text-neutral-700 rounded-lg hover:bg-neutral-50 transition-colors",children:"Scan Again"}),"unknown"!==m.type&&(0,r.jsx)("button",{onClick:()=>{if("profile"===m.type&&m.username)s.push("/pay/".concat(m.username));else{let e=new URLSearchParams;m.address&&e.set("to",m.address),m.amount&&e.set("amount",m.amount),m.currency&&e.set("currency",m.currency),m.message&&e.set("message",m.message),s.push("/send?".concat(e.toString()))}},className:"flex-1 px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Continue"})]})]})]})}),(0,r.jsx)(d,{isOpen:c,onClose:()=>u(!1),onScan:e=>{p(!0);let t=f(e);h(t),u(!1),setTimeout(()=>{if(p(!1),"profile"===t.type&&t.username)s.push("/pay/".concat(t.username));else if("payment_request"===t.type||"address"===t.type){let e=new URLSearchParams;t.address&&e.set("to",t.address),t.amount&&e.set("amount",t.amount),t.currency&&e.set("currency",t.currency),t.message&&e.set("message",t.message),s.push("/send?".concat(e.toString()))}},1e3)},title:"Scan Payment QR Code"})]})}},64513:(e,t,s)=>{"use strict";s.d(t,{N:()=>y});var r=s(74807),a=s(95423),n=s(93119),l=s(81619),i=s(79852),c=s(40475),d=s(69755),o=s(194);class u extends a.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,d.s)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m(e){let{children:t,isPresent:s,anchorX:n}=e,l=(0,a.useId)(),i=(0,a.useRef)(null),c=(0,a.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=(0,a.useContext)(o.Q);return(0,a.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:a,right:o}=c.current;if(s||!i.current||!e||!t)return;i.current.dataset.motionPopId=l;let u=document.createElement("style");return d&&(u.nonce=d),document.head.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(l,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===n?"left: ".concat(a):"right: ".concat(o),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{document.head.contains(u)&&document.head.removeChild(u)}},[s]),(0,r.jsx)(u,{isPresent:s,childRef:i,sizeRef:c,children:a.cloneElement(t,{ref:i})})}let h=e=>{let{children:t,initial:s,isPresent:n,onExitComplete:i,custom:d,presenceAffectsLayout:o,mode:u,anchorX:h}=e,p=(0,l.M)(x),f=(0,a.useId)(),j=!0,y=(0,a.useMemo)(()=>(j=!1,{id:f,initial:s,isPresent:n,custom:d,onExitComplete:e=>{for(let t of(p.set(e,!0),p.values()))if(!t)return;i&&i()},register:e=>(p.set(e,!1),()=>p.delete(e))}),[n,p,i]);return o&&j&&(y={...y}),(0,a.useMemo)(()=>{p.forEach((e,t)=>p.set(t,!1))},[n]),a.useEffect(()=>{n||p.size||!i||i()},[n]),"popLayout"===u&&(t=(0,r.jsx)(m,{isPresent:n,anchorX:h,children:t})),(0,r.jsx)(c.t.Provider,{value:y,children:t})};function x(){return new Map}var p=s(68444);let f=e=>e.key||"";function j(e){let t=[];return a.Children.forEach(e,e=>{(0,a.isValidElement)(e)&&t.push(e)}),t}let y=e=>{let{children:t,custom:s,initial:c=!0,onExitComplete:d,presenceAffectsLayout:o=!0,mode:u="sync",propagate:m=!1,anchorX:x="left"}=e,[y,b]=(0,p.xQ)(m),g=(0,a.useMemo)(()=>j(t),[t]),N=m&&!y?[]:g.map(f),v=(0,a.useRef)(!0),w=(0,a.useRef)(g),C=(0,l.M)(()=>new Map),[R,P]=(0,a.useState)(g),[k,S]=(0,a.useState)(g);(0,i.E)(()=>{v.current=!1,w.current=g;for(let e=0;e<k.length;e++){let t=f(k[e]);N.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[k,N.length,N.join("-")]);let E=[];if(g!==R){let e=[...g];for(let t=0;t<k.length;t++){let s=k[t],r=f(s);N.includes(r)||(e.splice(t,0,s),E.push(s))}return"wait"===u&&E.length&&(e=E),S(j(e)),P(g),null}let{forceRender:Q}=(0,a.useContext)(n.L);return(0,r.jsx)(r.Fragment,{children:k.map(e=>{let t=f(e),a=(!m||!!y)&&(g===k||N.includes(t));return(0,r.jsx)(h,{isPresent:a,initial:(!v.current||!!c)&&void 0,custom:s,presenceAffectsLayout:o,mode:u,onExitComplete:a?void 0:()=>{if(!C.has(t))return;C.set(t,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(null==Q||Q(),S(w.current),m&&(null==b||b()),d&&d())},anchorX:x,children:e},t)})})}},64538:(e,t,s)=>{Promise.resolve().then(s.bind(s,42781))}},e=>{var t=t=>e(e.s=t);e.O(0,[215,960,898,909,830,934,412,640,358],()=>t(64538)),_N_E=e.O()}]);